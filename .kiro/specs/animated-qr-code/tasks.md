# TOTP 动态验证码 MVP 实现任务列表

## 🚀 阶段 1: 核心功能快速实现 (MVP - 优先执行)

- [x] 1. 设置基础项目结构
  - 安装 crypto-js 依赖包
  - 创建 app/[locale]/totp 目录结构
  - 创建基础类型定义文件
  - _需求: 1.1, 1.2_

- [x] 2. 实现 TOTP 核心算法 (最小可用版本)
  - [x] 2.1 创建简化的 TOTP 服务
    - ✅ 实现基础 TOTP 算法 (仅支持 SHA-1, 6位, 30秒)
    - ✅ 实现密钥生成和 Base32 编码
    - ✅ 实现 OTPAuth URI 生成
    - _需求: 1.2, 1.3, 2.1, 2.5_

  - [x] 2.2 创建定时器服务
    - ✅ 实现 30 秒倒计时功能
    - ✅ 实现验证码自动更新机制
    - ✅ 实现高精度定时器服务
    - _需求: 3.1, 3.3_

- [x] 3. 创建基础 UI 组件
  - [x] 3.1 创建 TOTP 页面主组件
    - ✅ 实现服务名称和账户名输入表单
    - ✅ 显示生成的二维码
    - ✅ 显示当前验证码和倒计时
    - ✅ 添加复制和下载功能
    - _需求: 1.1, 2.1, 2.4, 3.1_

  - [x] 3.2 集成现有二维码组件
    - ✅ 复用 qr-code-styling 显示 TOTP 二维码
    - ✅ 确保二维码包含正确的 OTPAuth URI
    - ✅ 支持 PNG 和 SVG 格式下载
    - _需求: 1.3, 1.4_

- [x] 4. 添加页面路由和导航
  - [x] 4.1 创建 /totp 路由页面
    - ✅ 在主导航中添加 "动态验证码" 入口
    - ✅ 实现完整的响应式页面布局
    - ✅ 支持暗黑模式切换
    - _需求: 7.1_

  - [x] 4.2 添加基础国际化文本
    - ✅ 在 messages/zh.json 和 messages/en.json 中添加完整文本
    - ✅ 确保页面文本正确显示
    - ✅ 支持语言切换功能
    - _需求: 7.1_

- [x] 5. MVP 功能验证
  - [x] 5.1 测试基础功能
    - 验证能生成有效的 TOTP 二维码
    - 验证验证码每 30 秒正确更新
    - 验证二维码能被 Google Authenticator 扫描
    - _需求: 1.3, 2.1, 2.2_

## 🔧 阶段 2: 功能增强 (可选扩展)

- [ ]* 6. 添加高级配置选项
  - [ ]* 6.1 支持多种哈希算法 (SHA-256, SHA-512)
    - 扩展 TOTP 服务支持不同算法
    - _需求: 4.3_
  
  - [ ]* 6.2 支持不同验证码长度 (8位)
    - 添加验证码长度配置选项
    - _需求: 4.2_
  
  - [ ]* 6.3 支持不同时间窗口 (15秒, 60秒)
    - 添加时间窗口配置选项
    - _需求: 4.1_

- [ ]* 7. 添加验证码校验功能
  - [ ]* 7.1 创建验证码输入和校验界面
    - 实现验证码输入组件
    - 显示验证结果反馈
    - _需求: 6.1, 6.3, 6.4_
  
  - [ ]* 7.2 实现时间窗口容错验证
    - 支持当前和相邻时间窗口验证
    - 实现时间同步检测
    - _需求: 6.2, 6.5_

- [ ]* 8. 添加配置管理功能
  - [ ]* 8.1 实现配置导出 (密钥, URI, 二维码)
    - 添加密钥和 URI 导出功能
    - 支持二维码 PNG/SVG 格式保存
    - _需求: 5.1, 5.2, 5.3_
  
  - [ ]* 8.2 实现配置本地存储和管理
    - 使用 localStorage 保存配置
    - 实现配置列表和删除功能
    - _需求: 6.1, 6.2, 6.3_

- [ ]* 9. 移动端优化
  - [ ]* 9.1 优化移动端界面和交互
    - 优化触摸友好的界面元素
    - 调整二维码大小适应移动屏幕
    - _需求: 7.1, 7.2, 7.3_
  
  - [ ]* 9.2 优化移动端性能
    - 减少不必要的重渲染
    - 优化定时器使用
    - _需求: 7.4, 7.5_

## 🧪 阶段 3: 测试和质量保证 (可选)

- [ ]* 10. 属性测试实现
  - [ ]* 10.1 TOTP 算法正确性测试
    - **属性 3: TOTP 算法正确性**
    - **验证需求: 2.1, 2.5**
  
  - [ ]* 10.2 配置生成正确性测试
    - **属性 1: TOTP 配置生成正确性**
    - **验证需求: 1.1, 1.2**
  
  - [ ]* 10.3 URI 格式正确性测试
    - **属性 2: OTPAuth URI 格式正确性**
    - **验证需求: 1.3, 1.4, 4.5**

  - [ ]* 10.4 时间窗口一致性测试
    - **属性 4: 时间窗口一致性**
    - **验证需求: 2.2, 2.3**

  - [ ]* 10.5 倒计时计算正确性测试
    - **属性 5: 倒计时计算正确性**
    - **验证需求: 3.1, 3.3**

  - [ ]* 10.6 参数配置支持性测试
    - **属性 6: 参数配置支持性**
    - **验证需求: 4.1, 4.2, 4.3**

  - [ ]* 10.7 配置变更响应性测试
    - **属性 7: 配置变更响应性**
    - **验证需求: 4.4**

  - [ ]* 10.8 导出格式正确性测试
    - **属性 8: 导出格式正确性**
    - **验证需求: 5.1, 5.2, 5.3**

  - [ ]* 10.9 验证码校验正确性测试
    - **属性 9: 验证码校验正确性**
    - **验证需求: 6.1, 6.2**

  - [ ]* 10.10 时间同步检测测试
    - **属性 10: 时间同步检测**
    - **验证需求: 6.5**

- [ ]* 11. 集成测试
  - [ ]* 11.1 端到端功能测试
  - [ ]* 11.2 移动端兼容性测试
  - [ ]* 11.3 性能和安全测试

## 📋 快速启动建议

### 🎯 优先执行顺序:
1. **先完成阶段 1 (任务 1-5)** - 这将给您一个完全可用的 MVP
2. **MVP 可用后**，根据需要选择阶段 2 的功能增强
3. **最后考虑阶段 3** 的测试完善

### ✅ MVP 完成后您将拥有:
- **完整的 TOTP 二维码生成功能**
- **实时验证码显示和 30 秒倒计时**
- **与 Google Authenticator 完全兼容**
- **基础的用户界面和导航**
- **中英文国际化支持**

### 🚀 开始实现:
打开 tasks.md 文件，点击任务 1 旁边的 "Start task" 按钮开始实现！